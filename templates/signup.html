<!DOCTYPE html>

<html lang="en">

    <head>
        <meta charset="utf-8"></meta>
        <meta content="IE=edge" http-equiv="X-UA-Compatible"></meta>
        <meta content="width=device-width, initial-scale=1" name="viewport"></meta>
        <meta content="" name="description"></meta>
        <meta content="" name="author"></meta>
        <link href="../../assets/ico/favicon.ico" rel="shortcut icon"></link>
        <title>
            Sign Up
        </title>

        <link rel="stylesheet" href="{{ static_url("css/bootstrap.min.css") }}"></link>

        <link rel="stylesheet" href="{{ static_url("css/signup.css") }}"></link>

        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
        <script type="text/javascript">
        $(document).ready(function(){// DOM的onload事件处理函数
            // $("#submit").attr("disabled","true");
            $("#username").blur(function(){
                u_warning();
            });
            $("#pass2").blur(function(){// 当按钮submit被点击时的处理函数
                if (document.form.password1.value!=document.form.password2.value) {
                    p_warning("（密码不一致！）");// submit别点击时执行postdata函数
                    $("#submit").attr("disabled","true");
                }
                else{
                    p_warning("");
                    $("#submit").removeAttr('disabled');
                }
            });
            $("#submit").click(function(){
                if (document.form.password1.value==document.form.password2.value) {
                    postdata();
                }
            });
        });
        function u_warning(){
            $.ajax({// 调用jquery的ajax方法
                type:"POST",// 设置ajax方法提交数据的形式
                url:"/signup",// 把数据提交到/signup"
                data: "username="+$("#username").val(),
                success:function(msg){// 提交成功后的回调，msg变量是ok.php输出的内容
                    if (msg=="existing") {
                        $("#msg1").text("（该用户已存在！）");
                    };
                }
            });
        }
        function p_warning(msg){// 提交数据函数
            $("#msg2").text(msg);
        }
        function postdata(){// 提交数据函数
            $.ajax({// 调用jquery的ajax方法
            type:"POST",// 设置ajax方法提交数据的形式
            url:"/signup",// 把数据提交到/signup
            data: "username="+$("#username").val()+"&password="+$("#password2").val()+"&email="+$("#email"),
            success:function(msg){// 提交成功后的回调
                }
    });
}

        //刷新切换背景
        bg = new Array(3);
        bg[0] = '{{ static_url("images/pink.jpg") }}'
        bg[1] = '{{ static_url("images/blue.jpg") }}'
        bg[2] = '{{ static_url("images/sky.jpg") }}'
        index = Math.floor(Math.random() * bg.length);
        document.write("<BODY BACKGROUND="+bg[index]+">");

        </script>
    </head>


    <body>
        <div class="container">
            <form class="form-signup"  name="form" role="form">
            {% raw xsrf_form_html() %}
                <h2 class="form-signup-heading">
                Please Sign Up
                </h2>

                <h5>验证邮箱：</h5>
                <input class="form-control" name="email" id="email" type="email" autofocus="" required="" placeholder="Email address" ></input>

                <h5>输入账号：<span id="msg1" class="msg"></span></h5>
                <input class="form-control" id="username" name="username" type="text" autofocus="" required="" placeholder="Username"  onkeyup="value=value.replace(/[\W]/g,'') " onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))"></input>

                <h5>输入密码：</h5>
                <input class="form-control"  name="password1" id="password1" type="password" required="" placeholder="Password"  onkeyup="value=value.replace(/[\W]/g,'') " onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))"></input>

                <h5>再次输入密码：<span id="msg2" class="msg"></span></h5>
                <input class="form-control" id="pass2" name="password2" id="password2" type="password" required="" placeholder="Password"  onkeyup="value=value.replace(/[\W]/g,'') " onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))"></input>

                <button class="btn btn-lg btn-primary btn-block" id="submit" type="submit">
                Sign Up
                </button>
            </form>
        </div>
    </body>
</html>
